<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:material="clr-namespace:Material.Styles.Controls;assembly=Material.Styles"
        xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
        xmlns:assists="clr-namespace:Material.Styles.Assists;assembly=Material.Styles"
        xmlns:wpf="clr-namespace:Material.Styles.Assists;assembly=Material.Styles"
        xmlns:viewModels="clr-namespace:UI.ER.ViewModels.ViewModels"
        xmlns:pages="clr-namespace:UI.ER.AvaloniaUI.Pages"
        x:Class="UI.ER.AvaloniaUI.Pages.EtapaSetWindow"
        HorizontalContentAlignment="Stretch"
        Title="Etapa Educativa, llistat"        
        Width="1000" Height="700" MinWidth="720"
        WindowStartupLocation="CenterOwner"
        >
    <Design.DataContext>
        <viewModels:EtapaSetViewModel />
    </Design.DataContext>

    <Grid>

        <DockPanel>

            <!-- ==================== FILTRES ==================== -->
            <Border DockPanel.Dock="Top" 
                    Background="#F5F7FA" 
                    BorderBrush="#E0E0E0" BorderThickness="0,0,0,1"
                    Padding="16,14">
                <DockPanel>
                    <Border DockPanel.Dock="Right" 
                            Background="#E3F2FD" CornerRadius="12" 
                            Padding="12,4" Margin="8,0,0,0"
                            VerticalAlignment="Center"
                            IsVisible="{Binding PaginatedMsg, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                        <TextBlock Text="{Binding PaginatedMsg}"
                                   Classes="Caption" Foreground="#1565C0"
                                   VerticalAlignment="Center" />
                    </Border>
                    <StackPanel Orientation="Horizontal" Spacing="16">
                        <ToggleSwitch VerticalAlignment="Center"
                                    IsChecked="{Binding NomesActius}"
                                    Content="Filtrar nomÃ©s actius"
                                    Margin="0"
                                    Classes="LeftHeader" />
                    </StackPanel>
                </DockPanel>
            </Border>

            <!-- ==================== LOADING ==================== -->
            <StackPanel DockPanel.Dock="Top" 
                        Orientation="Horizontal" 
                        Margin="16,12" Spacing="8"
                        IsVisible="{Binding Loading}">
                <avalonia:MaterialIcon Kind="Loading" Width="18" Height="18" 
                                       Foreground="{DynamicResource PrimaryHueMidBrush}"
                                       Classes="Rotating" />
                <TextBlock Text="Carregant dades ..." Classes="Subtitle2"
                           Foreground="{DynamicResource PrimaryHueMidBrush}" />
            </StackPanel>

            <!-- ==================== ERRORS ==================== -->
            <ItemsControl DockPanel.Dock="Top"
                          Margin="16,4" 
                          ItemsSource="{Binding BrokenRules}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Classes="Error" Text="{Binding, Mode=OneWay}" Margin="0,2"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- ==================== RESULTATS ==================== -->
            <ListBox Margin="8,4,8,80"
                     ItemsSource="{Binding MyItems, Mode=OneWay}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <pages:EtapaRowUserCtrl/>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

        </DockPanel>

        <!-- ==================== FAB AFEGIR ==================== -->
        <material:FloatingButton
            HorizontalAlignment="Right" VerticalAlignment="Bottom"
            Margin="0,0,24,24"
            IsExtended="True"
            Command="{Binding Create}"
            HotKey="Ctrl++"
            ToolTip.Tip="Afegir una nova etapa (Ctrl++)">
            <material:FloatingButton.Content>
                <StackPanel Orientation="Horizontal" Height="24">
                    <Viewbox Stretch="Fill" VerticalAlignment="Stretch">
                        <avalonia:MaterialIcon Kind="Plus" Width="24" Height="24" />
                    </Viewbox>
                    <TextBlock Margin="8,0" Text="Nova etapa" Classes="Subtitle2"
                               VerticalAlignment="Center" />
                </StackPanel>
            </material:FloatingButton.Content>
        </material:FloatingButton>

    </Grid>
</Window>    