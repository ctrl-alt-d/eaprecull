<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:material="clr-namespace:Material.Styles.Controls;assembly=Material.Styles"
        xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
        xmlns:assists="clr-namespace:Material.Styles.Assists;assembly=Material.Styles"
        xmlns:wpf="clr-namespace:Material.Styles.Assists;assembly=Material.Styles"
        xmlns:viewModels="clr-namespace:UI.ER.ViewModels.ViewModels"
        xmlns:pages="clr-namespace:UI.ER.AvaloniaUI.Pages"
        x:Class="UI.ER.AvaloniaUI.Pages.AlumneSetWindow"
        HorizontalContentAlignment="Stretch"
        Title="Alumne, llistat"        
        Width="1000" Height="700" MinWidth="720"
        WindowStartupLocation="CenterOwner"
        >
    <Design.DataContext>
        <viewModels:AlumneSetViewModel />
    </Design.DataContext>

    <Grid>

        <DockPanel>

            <!-- ==================== CERCA ==================== -->
            <Border DockPanel.Dock="Top" 
                    Background="#F5F7FA" 
                    BorderBrush="#E0E0E0" BorderThickness="0,0,0,1"
                    Padding="16,14">
                <StackPanel Spacing="10">
                    <!-- Input de cerca -->
                    <DockPanel>
                        <avalonia:MaterialIcon DockPanel.Dock="Left"
                                               Kind="School" Width="28" Height="28"
                                               VerticalAlignment="Center" Margin="0,0,10,0" />
                    <TextBox Text="{Binding NomCognomsTagCentre}"
                             BorderBrush="{Binding $self.Foreground}" BorderThickness="1"
                             Classes="solo" Theme="{StaticResource SoloTextBox}"
                             Watermark="Cerca alumnes per nom, cognoms, centre i tags"
                             CornerRadius="32">
                        <TextBox.InnerLeftContent>
                            <Border Height="{Binding $parent[TextBox].Height}" Width="{Binding $self.Bounds.Height}">
                                <avalonia:MaterialIcon HorizontalAlignment="Center" VerticalAlignment="Center"
                                                       Kind="Magnify" Width="20" Height="20" />
                            </Border>
                        </TextBox.InnerLeftContent>
                    </TextBox>
                    </DockPanel>
                    <!-- Filtres i info -->
                    <DockPanel>
                        <Border DockPanel.Dock="Right" 
                                Background="#E3F2FD" CornerRadius="12" 
                                Padding="12,4" Margin="8,0,0,0"
                                VerticalAlignment="Center"
                                IsVisible="{Binding PaginatedMsg, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                            <TextBlock Text="{Binding PaginatedMsg}"
                                       Classes="Caption" Foreground="#1565C0"
                                       VerticalAlignment="Center" />
                        </Border>
                        <StackPanel Orientation="Horizontal" Spacing="16">
                            <ToggleSwitch VerticalAlignment="Center"
                                        IsChecked="{Binding NomesActius}"
                                        Content="Només actius "
                                        Margin="0"
                                        Classes="LeftHeader" />
                            <ToggleSwitch VerticalAlignment="Center"
                                        IsChecked="{Binding OrdreAlfabetic}"
                                        Content="Ordre alfabètic "
                                        Margin="0"
                                        Classes="LeftHeader" />
                        </StackPanel>
                    </DockPanel>
                </StackPanel>
            </Border>

            <!-- ==================== LOADING ==================== -->
            <StackPanel DockPanel.Dock="Top" 
                        Orientation="Horizontal" 
                        Margin="16,12" Spacing="8"
                        IsVisible="{Binding Loading}">
                <avalonia:MaterialIcon Kind="Loading" Width="18" Height="18" 
                                       Foreground="{DynamicResource PrimaryHueMidBrush}"
                                       Classes="Rotating" />
                <TextBlock Text="Carregant dades ..." Classes="Subtitle2"
                           Foreground="{DynamicResource PrimaryHueMidBrush}" />
            </StackPanel>

            <!-- ==================== ERRORS ==================== -->
            <ItemsControl DockPanel.Dock="Top"
                          Margin="16,4" 
                          ItemsSource="{Binding BrokenRules}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Classes="Error" Text="{Binding, Mode=OneWay}" Margin="0,2"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- ==================== RESULTATS ==================== -->
            <ListBox Margin="8,4,8,8"
                     ItemsSource="{Binding MyItems, Mode=OneWay}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <pages:AlumneRowUserCtrl/>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

        </DockPanel>

        <!-- ==================== FAB AFEGIR ==================== -->
        <material:FloatingButton
            HorizontalAlignment="Right" VerticalAlignment="Bottom"
            Margin="0,0,24,24"
            IsExtended="True"
            Command="{Binding Create}"
            HotKey="Ctrl++"
            ToolTip.Tip="Afegir un nou alumne (Ctrl++)">
            <material:FloatingButton.Content>
                <StackPanel Orientation="Horizontal" Height="24">
                    <Viewbox Stretch="Fill" VerticalAlignment="Stretch">
                        <avalonia:MaterialIcon Kind="Plus" Width="24" Height="24" />
                    </Viewbox>
                    <TextBlock Margin="8,0" Text="Nou alumne" Classes="Subtitle2"
                               VerticalAlignment="Center" />
                </StackPanel>
            </material:FloatingButton.Content>
        </material:FloatingButton>

    </Grid>
</Window>    